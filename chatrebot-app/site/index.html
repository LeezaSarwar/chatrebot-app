<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatRebot</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Google Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #1f1f1f;
            color: #e3e3e3;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 20px;
            background-color: #2d2d2d;
        }

        .left-section {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .menu-icon {
            width: 24px;
            height: 24px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: space-around;
        }

        .menu-icon span {
            width: 100%;
            height: 2px;
            background-color: #e3e3e3;
            border-radius: 2px;
        }

        .logo-section {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .logo {
            font-size: 20px;
            font-weight: 500;
            letter-spacing: -0.5px;
        }

        .version {
            font-size: 13px;
            color: #9aa0a6;
            display: flex;
            align-items: center;
            gap: 4px;
            cursor: pointer;
        }

        .upgrade-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background-color: #3c4043;
            border: none;
            border-radius: 20px;
            color: #e3e3e3;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .upgrade-btn:hover {
            background-color: #4a4d51;
        }

        .profile-pic {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            cursor: pointer;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            gap: 40px;
            overflow-y: auto;
        }

        .main-content.has-chat {
            justify-content: flex-start;
            padding-top: 40px;
        }

        .main-content.empty {
            justify-content: center;
        }

        .greeting {
            font-size: clamp(32px, 6vw, 48px);
            font-weight: 400;
            color: #8ab4f8;
            text-align: center;
        }

        .chat-container {
            width: 100%;
            max-width: 900px;
            display: none;
            flex-direction: column;
            gap: 24px;
            margin-bottom: 20px;
        }

        .chat-container.active {
            display: flex;
        }

        .message {
            display: flex;
            gap: 16px;
            padding: 16px;
            border-radius: 12px;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .user-message {
            background-color: #303134;
            margin-left: auto;
            max-width: 80%;
        }

        .assistant-message {
            background-color: #2d2d2d;
            max-width: 90%;
        }

        .error-message {
            background-color: #5f2120;
            border: 1px solid #8e2524;
            max-width: 90%;
        }

        .message-content {
            flex: 1;
            line-height: 1.6;
            white-space: pre-wrap;
        }

        .message-content a {
            color: #8ab4f8;
            text-decoration: none;
        }

        .message-content a:hover {
            text-decoration: underline;
        }

        .loading {
            display: flex;
            gap: 4px;
            padding: 8px 0;
        }

        .loading span {
            width: 8px;
            height: 8px;
            background-color: #8ab4f8;
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out;
        }

        .loading span:nth-child(1) { animation-delay: -0.32s; }
        .loading span:nth-child(2) { animation-delay: -0.16s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        .search-container {
            width: 100%;
            max-width: 900px;
            position: sticky;
            bottom: 20px;
        }

        .search-box {
            background-color: #303134;
            border-radius: 24px;
            padding: 16px 24px;
            display: flex;
            align-items: center;
            gap: 12px;
            border: 1px solid #3c4043;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .search-box:hover, .search-box:focus-within {
            border-color: #5f6368;
            box-shadow: 0 1px 6px rgba(0, 0, 0, 0.3);
        }

        .search-input {
            flex: 1;
            background: none;
            border: none;
            outline: none;
            color: #e3e3e3;
            font-size: 16px;
        }

        .search-input::placeholder {
            color: #9aa0a6;
        }

        .icon-btn {
            background: none;
            border: none;
            color: #9aa0a6;
            cursor: pointer;
            padding: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            border-radius: 8px;
            transition: background-color 0.2s;
        }

        .icon-btn:hover {
            background-color: #3c4043;
        }

        .icon-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .send-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #8ab4f8;
            color: #1f1f1f;
        }

        .send-btn:hover {
            background-color: #adc6ff;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .action-btn {
            background-color: #303134;
            border: 1px solid #3c4043;
            border-radius: 20px;
            padding: 12px 24px;
            color: #e3e3e3;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.2s, border-color 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .action-btn:hover {
            background-color: #3c4043;
            border-color: #5f6368;
        }

        @media (max-width: 768px) {
            .header {
                padding: 12px 16px;
            }

            .upgrade-btn span:first-child {
                display: inline;
            }

            .upgrade-btn span:last-child {
                display: none;
            }

            .main-content {
                gap: 30px;
                padding: 16px;
            }

            .search-box {
                padding: 14px 20px;
            }

            .user-message {
                max-width: 90%;
            }
        }

        /* Menu Dropdown Styles */
        .menu-dropdown {
            position: absolute;
            top: 60px;
            left: 20px;
            background-color: #3c3c3c;
            padding: 20px;
            border-radius: 10px;
            display: none;
            z-index: 10;
            width: 300px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .menu-dropdown label {
            display: block;
            margin-bottom: 10px;
            color: #ffffff;
            font-size: 14px;
        }

        .menu-dropdown select, .menu-dropdown input[type="range"] {
            width: 100%;
            margin-bottom: 20px;
            padding: 8px;
            background-color: #2c2c2c;
            color: #ffffff;
            border: none;
            border-radius: 4px;
        }

        .menu-dropdown input[type="range"] {
            margin-bottom: 10px;
        }

        .range-value {
            font-size: 12px;
            color: #9aa0a6;
            text-align: right;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="left-section">
            <div class="menu-icon" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <div class="logo-section">
                <div class="logo">ChatRebot</div>
                <div class="version" id="versionDisplay">2.5 Flash ▼</div>
            </div>
        </div>
        <div style="display: flex; align-items: center; gap: 12px;">
            <button class="upgrade-btn">
                <span>✨</span>
                <span>Upgrade to ChatRebot</span>
            </button>
            <div class="profile-pic"></div>
        </div>
    </div>

    <div class="main-content empty" id="mainContent">
        <h1 class="greeting" id="greeting">Hello! How can I help you?</h1>

        <div class="chat-container" id="chatContainer">
            <!-- Messages will be added here -->
        </div>

        <div class="search-container">
            <div class="search-box">
                <input type="text" class="search-input" id="searchInput" placeholder="Ask ChatRebot">
                <button class="icon-btn send-btn" id="sendBtn">
                    <span>↑</span>
                </button>
            </div>
        </div>

        <div class="action-buttons" id="actionButtons">
            <button class="action-btn" onclick="setPrompt('Create an image of a sunset')">
                <span>🎨</span>
                Create Image
            </button>
            <button class="action-btn" onclick="setPrompt('Help me write a professional email')">Write</button>
            <button class="action-btn" onclick="setPrompt('Help me build a web application')">Build</button>
            <button class="action-btn" onclick="setPrompt('Teach me about quantum physics')">Learn</button>
        </div>
    </div>

    <!-- Menu Dropdown -->
    <div class="menu-dropdown" id="menuDropdown">
        <label>Reasoning Method:</label>
        <select id="reasoningMethod">
            <option value="chain">Chain of Thought</option>
            <option value="tree">Tree of Thought</option>
            <option value="both">Both</option>
            <option value="none">None</option>
        </select>

        <label>Temperature: <span id="tempValue" class="range-value">0.7</span></label>
        <input type="range" id="temperature" min="0" max="1" step="0.1" value="0.7" oninput="updateTempValue(this.value)">

        <label>Top P: <span id="topPValue" class="range-value">0.95</span></label>
        <input type="range" id="topP" min="0" max="1" step="0.1" value="0.95" oninput="updateTopPValue(this.value)">

        <label>Model:</label>
        <select id="modelSelect" onchange="handleModelChange()">
            <option value="gemini-2.0-flash">2.0 Flash</option>
            <option value="gemini-2.5-flash" selected>2.5 Flash</option>
            <option value="gemini-2.5-pro">2.5 Pro</option>
        </select>
    </div>

    <script>
        const API_KEY = 'AIzaSyDedZHxU__inYefA6yLo8fEZYNy0hX8yxQ'; // Replace with your actual API key
        
        const searchInput = document.getElementById('searchInput');
        const sendBtn = document.getElementById('sendBtn');
        const chatContainer = document.getElementById('chatContainer');
        const mainContent = document.getElementById('mainContent');
        const greeting = document.getElementById('greeting');
        const actionButtons = document.getElementById('actionButtons');
        const versionDisplay = document.getElementById('versionDisplay');
        const menuDropdown = document.getElementById('menuDropdown');
        
        let conversationHistory = [];
        let currentModel = 'gemini-2.5-flash'; // Updated default model

        const CREATOR_INFO = {
            name: "Leeza Sarwar",
            profiles: {
                github: "https://github.com/LeezaSarwar",
                linkedin: "https://www.linkedin.com/in/leeza-sarwar-21ab61339/?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app",
                twitter: "https://x.com/LeezaSarwar?t=GuicOuNUal0TEmJ6UN4FAA&s=09",
                fiverr: "https://www.fiverr.com/leeza_sarwar",
                upwork: "https://www.upwork.com/freelancers/~018898ff181d6b8282"
            }
        };

        function toggleMenu() {
            menuDropdown.style.display = menuDropdown.style.display === 'none' ? 'block' : 'none';
        }

        function updateTempValue(value) {
            document.getElementById('tempValue').textContent = value;
        }

        function updateTopPValue(value) {
            document.getElementById('topPValue').textContent = value;
        }

        function handleModelChange() {
            const selected = document.getElementById('modelSelect').value;
            if (selected === 'gemini-2.0-flash') {
                alert('Coming soon');
                document.getElementById('modelSelect').value = 'gemini-2.5-flash'; // Reset to default
                currentModel = 'gemini-2.5-flash';
                versionDisplay.textContent = '2.5 Flash ▼';
            } else {
                currentModel = selected;
                const modelName = selected.replace('gemini-', '').replace('-exp', '');
                versionDisplay.textContent = `${modelName} ▼`;
            }
        }

        function setPrompt(text) {
            searchInput.value = text;
            searchInput.focus();
        }

        function checkCreatorQuery(message) {
            const creatorKeywords = [
                'who created you', 'who made you', 'who built you', 
                'your creator', 'your developer', 'who is your maker',
                'who developed you', 'who designed you', 'your owner',
                'tumhe kisne banaya', 'tumhara creator kaun hai'
            ];
            return creatorKeywords.some(keyword => message.toLowerCase().includes(keyword));
        }

        function checkImageQuery(message) {
            const imageKeywords = [
                'create image', 'generate image', 'make image',
                'draw', 'illustrate', 'picture of'
            ];
            return imageKeywords.some(keyword => message.toLowerCase().includes(keyword));
        }

        async function sendMessage() {
            const message = searchInput.value.trim();
            if (!message) return;

            if (API_KEY === 'YOUR_GEMINI_API_KEY_HERE' || !API_KEY) {
                return;
            }

            // Hide greeting and action buttons on first message
            if (conversationHistory.length === 0) {
                greeting.style.display = 'none';
                actionButtons.style.display = 'none';
                mainContent.classList.remove('empty');
                mainContent.classList.add('has-chat');
                chatContainer.classList.add('active');
            }

            // Add user message to UI
            addMessage(message, 'user');
            searchInput.value = '';
            sendBtn.disabled = true;

            // Guardrail for image generation
            if (checkImageQuery(message)) {
                const guardResponse = 'Is there a text-based agent? If you want to generate images, you can use our 2.0 Flash model.';
                setTimeout(() => {
                    addMessage(guardResponse, 'assistant');
                    sendBtn.disabled = false;
                }, 500);
                return;
            }

            // Check if asking about creator
            if (checkCreatorQuery(message)) {
                const creatorResponse = `I was created by ${CREATOR_INFO.name}! 🌟

You can connect with her on:
• GitHub: ${CREATOR_INFO.profiles.github}
• LinkedIn: ${CREATOR_INFO.profiles.linkedin}
• Twitter: ${CREATOR_INFO.profiles.twitter}
• Fiverr: ${CREATOR_INFO.profiles.fiverr}
• Upwork: ${CREATOR_INFO.profiles.upwork}`;

                setTimeout(() => {
                    addMessage(creatorResponse, 'assistant', true);
                    sendBtn.disabled = false;
                }, 500);
                return;
            }

            // Get settings from menu
            const reasoning = document.getElementById('reasoningMethod').value;
            const temperature = parseFloat(document.getElementById('temperature').value);
            const topP = parseFloat(document.getElementById('topP').value);

            // Modify prompt based on reasoning
            let modifiedMessage = message;
            if (reasoning === 'chain') {
                modifiedMessage = `Use chain of thought: think step by step.\n\n${message}`;
            } else if (reasoning === 'tree') {
                modifiedMessage = `Use tree of thought: explore multiple reasoning paths and select the best.\n\n${message}`;
            } else if (reasoning === 'both') {
                modifiedMessage = `Use both chain of thought and tree of thought: think step by step while exploring multiple paths.\n\n${message}`;
            }

            // Add to conversation history
            conversationHistory.push({
                role: 'user',
                content: modifiedMessage
            });

            // Show loading indicator
            const loadingId = addLoadingMessage();

            try {
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${currentModel}:generateContent?key=${API_KEY}`;
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: conversationHistory.map(c => ({
                            role: c.role === 'assistant' ? 'model' : 'user',
                            parts: [{ text: c.content }]
                        })),
                        generationConfig: {
                            temperature: temperature,
                            topP: topP,
                            maxOutputTokens: 2048,
                        }
                    })
                });

                removeLoadingMessage(loadingId);

                if (!response.ok) {
                    const errorText = await response.text();
                    let errorMsg = 'API request failed';
                    try {
                        const errorJson = JSON.parse(errorText);
                        errorMsg = errorJson.error?.message || errorMsg;
                    } catch (e) {
                        errorMsg = `${response.status}: ${response.statusText}`;
                    }
                    throw new Error(errorMsg);
                }

                const data = await response.json();
                
                if (!data.candidates || data.candidates.length === 0) {
                    throw new Error('No response generated. Try again.');
                }

                const assistantMessage = data.candidates[0].content.parts[0].text;

                // Add assistant response to UI
                addMessage(assistantMessage, 'assistant');

                // Add to conversation history
                conversationHistory.push({
                    role: 'assistant',
                    content: assistantMessage
                });

            } catch (error) {
                removeLoadingMessage(loadingId);
                let errorMessage = error.message;
                
                if (error.message.includes('API_KEY_INVALID')) {
                    errorMessage = 'Invalid API key. Get your key from: https://aistudio.google.com/apikey';
                } else if (error.message.includes('Failed to fetch')) {
                    errorMessage = 'Network error. Check your internet connection.';
                } else if (error.message.includes('not found for API version v1beta')) {
                    errorMessage = 'Model not supported in v1beta. Please update to a supported model like gemini-2.5-flash or gemini-2.5-pro from the menu.';
                }
                
                addMessage(`Error: ${errorMessage}`, 'error');
                console.error('Error:', error);
            } finally {
                sendBtn.disabled = false;
            }
        }

        function addMessage(content, type, hasLinks = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}-message`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            if (hasLinks) {
                // Convert URLs to clickable links
                contentDiv.innerHTML = content.replace(
                    /(https?:\/\/[^\s]+)/g, 
                    '<a href="$1" target="_blank">$1</a>'
                );
            } else {
                contentDiv.textContent = content;
            }
            
            messageDiv.appendChild(contentDiv);
            chatContainer.appendChild(messageDiv);
            
            // Scroll to bottom
            messageDiv.scrollIntoView({ behavior: 'smooth', block: 'end' });
        }

        function addLoadingMessage() {
            const loadingId = 'loading-' + Date.now();
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message assistant-message';
            messageDiv.id = loadingId;
            
            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'loading';
            loadingDiv.innerHTML = '<span></span><span></span><span></span>';
            
            messageDiv.appendChild(loadingDiv);
            chatContainer.appendChild(messageDiv);
            messageDiv.scrollIntoView({ behavior: 'smooth', block: 'end' });
            
            return loadingId;
        }

        function removeLoadingMessage(loadingId) {
            const loadingMsg = document.getElementById(loadingId);
            if (loadingMsg) {
                loadingMsg.remove();
            }
        }

        // Event listeners
        sendBtn.addEventListener('click', sendMessage);
        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });
    </script>
</body>
</html>